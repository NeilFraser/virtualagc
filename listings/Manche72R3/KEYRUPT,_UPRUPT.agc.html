<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
<title>Assembly listing generated by yaYUL</title>
<style type="text/css">
p.nobreak { white-space:nowrap; }
a { text-decoration:none; }
</style>
<style type="text/css">
.op{
font-weight: bold;
color: #993300;
}
</style>
<style type="text/css">
.dn{
color: #009900;
}
</style>
<style type="text/css">
.fe{
color: #FF0000;
}
</style>
<style type="text/css">
.in{
color: #FF6600;
}
</style>
<style type="text/css">
.ps{
color: #336600;
}
</style>
<style type="text/css">
.sm{
color: #0000FF;
}
</style>
<style type="text/css">
.wn{
color: #FF9900;
}
</style>
<style type="text/css">
.co{
font-style: italic;
color: #993399;
}
</style>
</head>
<body>
<p class="nobreak">
<span style="font-family: monospace;">
<pre>
<h1>Source Code</h1>
</pre>
</span>
</p>
<table style="text-align: left;" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="white-space: nowrap; vertical-align: middle;">
<img alt="" src="Apollo32.png" style="width: 32px; height: 32px;" align="left">
</td>
<td style="vertical-align: middle;">
These source-code files are part of a reconstructed copy of Comanche 72/3 (AKA Manche72 revision 3),
the final, flown mission release of the Apollo Guidance Computer (AGC) Command Module (CM) software
for Apollo 13.
<br><br>
The starting point was the source code of Comanche 72 (itself previously reconstructed). Comanche 72
source code was then modified by incorporating changes known from contemporary documentation to have
been made between revisions 72 and 72/3.  The resulting code assembles to have identical
memory-bank checksums as those specified in NASA drawing 2021153G; this gives reasonably
high confidence that the changes that have been made are correct. In places where
ambiguity exists, this ambiguity is discussed in "## Reconstruction:" comments.
<br><br>
Since no contemporary listings of Comanche 72/3 are available as source material, 
all comments and labels are approximate.
They have been taken from other AGC programs where possible, or, in some places, written
from scratch to match what we believe would have been in the original listing.
</td></tr></tbody></table>

<p class="nobreak">
<span style="font-family: monospace;">
<pre>
060319,000002:                                                                                                  <span class="co">## Copyright:   Public domain.</span>
060320,000003:                                                                                                  <span class="co">## Filename:    KEYRUPT,_UPRUPT.agc</span>
060321,000004:                                                                                                  <span class="co">## Purpose:     A section of Manche72 revision 3.</span>
060322,000005:                                                                                                  <span class="co">##              It is part of the reconstructed source code for the final, flown</span>
060323,000006:                                                                                                  <span class="co">##              release of the software for the Command Module's (CM) Apollo</span>
060324,000007:                                                                                                  <span class="co">##              Guidance Computer (AGC) for Apollo 13. No original listings</span>
060325,000008:                                                                                                  <span class="co">##              of this program are available; instead, this file was recreated</span>
060326,000009:                                                                                                  <span class="co">##              from a reconstructed copy of Comanche 072. It has been adapted</span>
060327,000010:                                                                                                  <span class="co">##              such that the resulting bugger words exactly match those</span>
060328,000011:                                                                                                  <span class="co">##              specified for Manche72 revision 3 in NASA drawing 2021153G,</span>
060329,000012:                                                                                                  <span class="co">##              which gives relatively high confidence that the reconstruction</span>
060330,000013:                                                                                                  <span class="co">##              is correct.</span>
060331,000014:                                                                                                  <span class="co">## Assembler:   yaYUL</span>
060332,000015:                                                                                                  <span class="co">## Contact:     Ron Burkey &lt;info@sandroid.org>.</span>
060333,000016:                                                                                                  <span class="co">## Website:     www.ibiblio.org/apollo/index.html</span>
060334,000017:                                                                                                  <span class="co">## Mod history: 2024-05-19 MAS  Created from Comanche 072.</span>
060335,000018: 
060336,000019: 14,3765                                           <span class="ps">BANK    </span> 14                                    
060337,000020: 07,2000                                           <span class="ps">SETLOC  </span> <a href="TAGS_FOR_RELATIVE_SETLOC_AND_BLANK_BANK_CARDS.agc.html#4B455952555054">KEYRUPT</a>                               
060338,000021: 07,2000                                           <span class="ps">BANK    </span>                                       
060339,000022: 07,3673                                           <span class="ps">COUNT*  </span> $$/KEYUP                              
060340,000023: 
<a name="4B45595255505431"></a>060341,000024: 07,3673           54016        <span class="sm">KEYRUPT1</span>           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#42414E4B52555054">BANKRUPT</a>                              
060342,000025: 07,3674           56002                           <span class="op">XCH     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#51">Q</a>                                     
060343,000026: 07,3675           54012                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#5152555054">QRUPT</a>                                 
060344,000027: 07,3676           04414                           <span class="op">TC      </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4C4F4453414D5054">LODSAMPT</a>                              <span class="co">#  TIME IS SNATCHED IN RUPT FOR NOUN 65.</span>
060345,000028: 07,3677           34362                           <span class="op">CAF     </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4C4F5735">LOW5</a>                                  
060346,000029: 07,3700           00006                           <span class="op">EXTEND  </span>                                       
060347,000030: 07,3701           02015                           <span class="op">RAND    </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4D4E4B4559494E">MNKEYIN</a>                               <span class="co">#  CHECK IF KEYS 5M-1M ON</span>
<a name="4B4559434F4D"></a>060348,000031: 07,3702           54073        <span class="sm">KEYCOM  </span>           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#5255505452454734">RUPTREG4</a>                              
060349,000032: 07,3703           40101                           <span class="op">CS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#464C414757524435">FLAGWRD5</a>                              
060350,000033: 07,3704           75015                           <span class="op">MASK    </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#4249543135">BIT15</a>                                 
060351,000034: 07,3705           26101                           <span class="op">ADS     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#464C414757524435">FLAGWRD5</a>                              
060352,000035: 
<a name="4143434550545550"></a>060353,000036: 07,3706           34371        <span class="sm">ACCEPTUP</span>           <span class="op">CAF     </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4348525052494F">CHRPRIO</a>                               <span class="co">#  (NOTE: RUPTREG4 = KEYTEMP1)</span>
060354,000037: 07,3707           05150                           <span class="op">TC      </span> <a href="EXECUTIVE.agc.html#4E4F564143">NOVAC</a>                                 
060355,000038: 07,3710     0777                                  <span class="ps">EBANK=  </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#445350434F554E54">DSPCOUNT</a>                              
060356,000039: 07,3710           02000 60101                     <span class="ps">2CADR   </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#43484152494E">CHARIN</a>                                
060357,000040: 
060358,000041: 07,3712           30073                           <span class="op">CA      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#5255505452454734">RUPTREG4</a>                              
060359,000042: 07,3713           50064                           <span class="op">INDEX   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4C4F43435452">LOCCTR</a>                                
060360,000043: 07,3714           54154                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4D504143">MPAC</a>                                  <span class="co">#  LEAVE 5 BIT KEY CDE IN MPAC FOR CHARIN</span>
060361,000044: 07,3715           05347                           <span class="op">TC      </span> <a href="WAITLIST.agc.html#524553554D45">RESUME</a>                                
060362,000045: 
060363,000046:                                                                                                  <span class="co">#  UPRUPT PROGRAM</span>
060364,000047: 
<a name="555052555054"></a>060365,000048: 07,3716           54016        <span class="sm">UPRUPT  </span>           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#42414E4B52555054">BANKRUPT</a>                              
060366,000049: 07,3717           56002                           <span class="op">XCH     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#51">Q</a>                                     
060367,000050: 07,3720           54012                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#5152555054">QRUPT</a>                                 
060368,000051: 07,3721           04414                           <span class="op">TC      </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4C4F4453414D5054">LODSAMPT</a>                              <span class="co">#  TIME IS SNATCHED IN RUPT FOR NOUN 65.</span>
060369,000052: 07,3722           35035                           <span class="op">CAF     </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#5A45524F">ZERO</a>                                  
060370,000053: 07,3723           56045                           <span class="op">XCH     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#494E4C494E4B">INLINK</a>                                
060371,000054: 07,3724           54073                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5031">KEYTEMP1</a>                              
060372,000055: 07,3725           35031                           <span class="op">CAF     </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#42495433">BIT3</a>                                  <span class="co">#  TURN ON UPACT LIGHT</span>
060373,000056: 07,3726           00006                           <span class="op">EXTEND  </span>                                       <span class="co">#  (BIT 3 OF CHANNEL 11)</span>
060374,000057: 07,3727           05011                           <span class="op">WOR     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4453414C4D4F5554">DSALMOUT</a>                              
<a name="555052505431"></a>060375,000058: 07,3730           34362        <span class="sm">UPRPT1  </span>           <span class="op">CAF     </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4C4F5735">LOW5</a>                                  <span class="co">#  TEST FOR TRIPLE CHAR REDUNDANCY</span>
060376,000059: 07,3731           70073                           <span class="op">MASK    </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5031">KEYTEMP1</a>                              <span class="co">#  LOW5 OF WORD</span>
060377,000060: 07,3732           56073                           <span class="op">XCH     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5031">KEYTEMP1</a>                              <span class="co">#  LOW5 INTO KEYTEMP1</span>
060378,000061: 07,3733           00006                           <span class="op">EXTEND  </span>                                       
060379,000062: 07,3734           75022                           <span class="op">MP      </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#4249543130">BIT10</a>                                 <span class="co">#  SHIFT RIGHT 5</span>
060380,000063: 07,3735           54734                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5032">KEYTEMP2</a>                              
060381,000064: 07,3736           74362                           <span class="op">MASK    </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4C4F5735">LOW5</a>                                  <span class="co">#  MID 5</span>
060382,000065: 07,3737           63773                           <span class="op">AD      </span> <a href="#48493130">HI10</a>                                  
060383,000066: 07,3740           03770                           <span class="op">TC      </span> <a href="#555054455354">UPTEST</a>                                
060384,000067: 07,3741           35022                           <span class="op">CAF     </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#4249543130">BIT10</a>                                 
060385,000068: 07,3742           00006                           <span class="op">EXTEND  </span>                                       
060386,000069: 07,3743           70734                           <span class="op">MP      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5032">KEYTEMP2</a>                              <span class="co">#  SHIFT RIGHT 5</span>
060387,000070: 07,3744           74362                           <span class="op">MASK    </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4C4F5735">LOW5</a>                                  <span class="co">#  HIGH 5</span>
060388,000071: 07,3745           40000                           <span class="op">COM     </span>                                       
060389,000072: 07,3746           03770                           <span class="op">TC      </span> <a href="#555054455354">UPTEST</a>                                
060390,000073: 
<a name="55504F4B"></a>060391,000074: 07,3747           43776        <span class="sm">UPOK    </span>           <span class="op">CS      </span> <a href="#454C52434F4445">ELRCODE</a>                               <span class="co">#  CODE IS GOOD.  IF CODE = 'ERROR RESET',</span>
060392,000075: 07,3750           60073                           <span class="op">AD      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5031">KEYTEMP1</a>                              <span class="co">#  CLEAR UPLOCKFL (SET BIT4 OF FLAGWRD7 = 0)</span>
060393,000076: 07,3751           00006                           <span class="op">EXTEND  </span>                                       <span class="co">#  IF CODE DOES NOT = 'ERROR RESET', ACCEPT</span>
060394,000077: 07,3752           13760                           <span class="op">BZF     </span> <a href="#434C55504C4F434B">CLUPLOCK</a>                              <span class="co">#  CODE ONLY IF UPLOCKFL IS CLEAR (=0).</span>
060395,000078: 
060396,000079: 07,3753           35030                           <span class="op">CAF     </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#42495434">BIT4</a>                                  <span class="co">#  TEST UPLOCKFL FOR 0 OR 1.</span>
060397,000080: 07,3754           70103                           <span class="op">MASK    </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#464C414757524437">FLAGWRD7</a>                              
060398,000081: 07,3755           10000                           <span class="op">CCS     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#41">A</a>                                     
060399,000082: 07,3756           05347                           <span class="op">TC      </span> <a href="WAITLIST.agc.html#524553554D45">RESUME</a>                                <span class="co">#  UPLOCKFL = 1</span>
060400,000083: 07,3757           03706                           <span class="op">TC      </span> <a href="#4143434550545550">ACCEPTUP</a>                              <span class="co">#  UPLOCKFL = 0</span>
060401,000084: 
<a name="434C55504C4F434B"></a>060402,000085: 07,3760           45030        <span class="sm">CLUPLOCK</span>           <span class="op">CS      </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#42495434">BIT4</a>                                  <span class="co">#  CLEAR UPLOCKFL (I.E., SET BIT 4 OF</span>
060403,000086: 07,3761           70103                           <span class="op">MASK    </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#464C414757524437">FLAGWRD7</a>                              <span class="co">#  FLAGWRD7 = 0)</span>
060404,000087: 07,3762           54103                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#464C414757524437">FLAGWRD7</a>                              
060405,000088: 07,3763           03706                           <span class="op">TC      </span> <a href="#4143434550545550">ACCEPTUP</a>                              
060406,000089: 
060407,000090:                                                                                                  <span class="co">#  CODE IS BAD</span>
<a name="544D4641494C32"></a>060408,000091: 07,3764           40103        <span class="sm">TMFAIL2 </span>           <span class="op">CS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#464C414757524437">FLAGWRD7</a>                              <span class="co">#  LOCK OUT FURTHER UPLINK ACTIVITY</span>
060409,000092: 07,3765           75030                           <span class="op">MASK    </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#42495434">BIT4</a>                                  <span class="co">#  (BY SETTING UPLOCKFL = 1) UNTIL</span>
060410,000093: 07,3766           26103                           <span class="op">ADS     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#464C414757524437">FLAGWRD7</a>                              <span class="co">#  'ERROR RESET' IS SENT VIA UPLINK.</span>
060411,000094: 07,3767           05347                           <span class="op">TC      </span> <a href="WAITLIST.agc.html#524553554D45">RESUME</a>                                
<a name="555054455354"></a>060412,000095: 07,3770           60073        <span class="sm">UPTEST  </span>           <span class="op">AD      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5031">KEYTEMP1</a>                              
060413,000096: 07,3771           10000                           <span class="op">CCS     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#41">A</a>                                     
060414,000097: 07,3772           03764                           <span class="op">TC      </span> <a href="#544D4641494C32">TMFAIL2</a>                               
<a name="48493130"></a>060415,000098: 07,3773           77740        <span class="sm">HI10    </span>           <span class="ps">OCT     </span> 77740                                 
060416,000099: 07,3774           03764                           <span class="op">TC      </span> <a href="#544D4641494C32">TMFAIL2</a>                               
060417,000100: 07,3775           00002                           <span class="op">TC      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#51">Q</a>                                     
060418,000101: 
<a name="454C52434F4445"></a>060419,000102: 07,3776           00022        <span class="sm">ELRCODE </span>           <span class="ps">OCT     </span> 22                                    
060420,000103: 
060421,000104:                                                                                                  <span class="co">#  'UPLINK ACTIVITY LIGHT' IS TURNED OFF BY .....</span>
060422,000105:                                                                                                  <span class="co">#        1.      VBRELDSP</span>
060423,000106:                                                                                                  <span class="co">#        2.      ERROR RESET</span>
060424,000107:                                                                                                  <span class="co">#        3.      UPDATE PROGRAM (P27) ENTERED BY V70,V71,V72, AND V73.</span>
060425,000108: 
060426,000109:                                                                                                  <span class="co">#                                     -</span>
060427,000110:                                                                                                  <span class="co">#  THE RECEPTION OF A BAD CODE (I.E  CCC FAILURE) LOCKS OUT FURTHER UPLINK ACTIVITY BY SETTING BIT4 OF FLAGWRD7 = 1.</span>
060428,000111:                                                                                                  <span class="co">#  THIS INDICATION WILL BE TRANSFERRED TO THE GROUND BY THE DOWNLINK WHICH DOWNLINKS ALL FLAGWORDS.</span>
060429,000112:                                                                                                  <span class="co">#  WHEN UPLINK ACTIVITY IS LOCKED OUT, IT CAN BE ALLOWED WHEN THE GROUND UPLINKS AND 'ERROR RESET' CODE.</span>
060430,000113:                                                                                                  <span class="co">#  (IT IS RECOMMENDED THAT THE 'ERROR LIGHT RESET' CODE IS PRECEEDED BY 16 BITS THE FIRST OF WHICH IS 1 FOLLOWED</span>
060431,000114:                                                                                                  <span class="co">#  BY 15 ZEROES.  THIS WILL ELIMINATE EXTRANEOUS BITS FROM INLINK WHICH MAY HAVE BEEN LEFT OVER FROM THE ORIGINAL</span>
060432,000115:                                                                                                  <span class="co">#  FAILURE)</span>
060433,000116: 
060434,000117:                                                                                                  <span class="co">#  UPLINK ACTIVITY IS ALSO ALLOWED (UNLOCKED) DURING FRESH START WHEN FRESH START SETS BIT4 OF FLAGWRD7 = 0.</span>
060435,000118: 
060436,000119: 

End of include-file KEYRUPT,_UPRUPT.agc.  Parent file is <a href="MAIN.agc.html">MAIN.agc</a>
</pre>
</span>
</p>
</body>
</html>
