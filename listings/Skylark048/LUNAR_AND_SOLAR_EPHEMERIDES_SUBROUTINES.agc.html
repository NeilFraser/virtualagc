<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
<title>Assembly listing generated by yaYUL</title>
<style type="text/css">
p.nobreak { white-space:nowrap; }
a { text-decoration:none; }
</style>
<style type="text/css">
.op{
font-weight: bold;
color: #993300;
}
</style>
<style type="text/css">
.dn{
color: #009900;
}
</style>
<style type="text/css">
.fe{
color: #FF0000;
}
</style>
<style type="text/css">
.in{
color: #FF6600;
}
</style>
<style type="text/css">
.ps{
color: #336600;
}
</style>
<style type="text/css">
.sm{
color: #0000FF;
}
</style>
<style type="text/css">
.wn{
color: #FF9900;
}
</style>
<style type="text/css">
.co{
font-style: italic;
color: #993399;
}
</style>
</head>
<body>
<p class="nobreak">
<span style="font-family: monospace;">
<pre>
<h1>Source Code</h1>
</pre>
</span>
</p>
<table style="text-align: left;" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="white-space: nowrap; vertical-align: middle;">
<img alt="" src="Apollo32.png" style="width: 32px; height: 32px;" align="left">
</td>
<td style="vertical-align: middle;">
These source-code files are part of a reconstructed copy of Skylark 048, the
Block II Command Module (CM) Apollo Guidance Computer (AGC) software for the
Skylab-2, Skylab-3, Skylab-4, and Apollo-Soyuz Test Project missions.
<br>
<br>
They have been created via disassembly of binary dumps of the original core rope
memory modules actually flown on Skylab-2, part numbers 2010802-541, 2010802-551,
2010802-561, 2010802-571, 2010802-581, and 2010802-591. Access to these modules
was provided by the New Mexico Museum of Space History, who we are much indebted to.
<br>
<br>
The source code for the Apollo 15, 16, and 17 software, Artemis 072, was used as
a starting point. Heavy use was made of TRW 4900.5-244, Programmed Guidance Equations
for Skylark Command Module Earth Orbital Program, dated 14 February 1972. This document
contains pseudocode of essentially all of Skylark, using original program labels which
have been copied for this source reconstruction.
<br>
<br>
Since only binary dumps (rather than listings) of Skylark are available as source material, 
all comments and labels are approximate.
They have been taken from the Programmed Guidance Equations or other AGC programs where
possible, or, in some places, written from scratch to match what we believe would have
been in the original listing.
</td></tr></tbody></table>

<p class="nobreak">
<span style="font-family: monospace;">
<pre>
033313,000002:                                                                                                  <span class="co">## Copyright:   Public domain.</span>
033314,000003:                                                                                                  <span class="co">## Filename:    LUNAR_AND_SOLAR_EPHEMERIDES_SUBROUTINES.agc</span>
033315,000004:                                                                                                  <span class="co">## Purpose:     A section of Skylark revision 048.</span>
033316,000005:                                                                                                  <span class="co">##              It is part of the source code for the Apollo Guidance Computer (AGC)</span>
033317,000006:                                                                                                  <span class="co">##              for Skylab-2, Skylab-3, Skylab-4, and ASTP. No original listings of</span>
033318,000007:                                                                                                  <span class="co">##              this software are available; instead, this file was created via</span>
033319,000008:                                                                                                  <span class="co">##              disassembly of dumps of the core rope modules actually flown on</span>
033320,000009:                                                                                                  <span class="co">##              Skylab-2. Access to these modules was provided by the New Mexico</span>
033321,000010:                                                                                                  <span class="co">##              Museum of Space History.</span>
033322,000011:                                                                                                  <span class="co">## Assembler:   yaYUL</span>
033323,000012:                                                                                                  <span class="co">## Contact:     Ron Burkey &lt;info@sandroid.org>.</span>
033324,000013:                                                                                                  <span class="co">## Website:     www.ibiblio.org/apollo/index.html</span>
033325,000014:                                                                                                  <span class="co">## Mod history: 2024-02-19 MAS  Created from Luminary 131.</span>
033326,000015:                                                                                                  <span class="co">##              2024-03-04 MAS  Updated for Skylark 48.</span>
033327,000016: 
033328,000017:                                                                                                  <span class="co">#  NAME - LSPOS - LOCATE SUN AND MOON                    DATE - 25 OCT 67</span>
033329,000018:                                                                                                  <span class="co">#  MOD NO.1</span>
033330,000019:                                                                                                  <span class="co">#  MOD BY NEVILLE                                        ASSEMBLY SUNDANCE</span>
033331,000020: 
033332,000021:                                                                                                  <span class="co">#  FUNCTIONAL DESCRIPTION</span>
033333,000022: 
033334,000023:                                                                                                  <span class="co">#  COMPUTES UNIT POSITION VECTOR OF THE SUN AND MOON IN THE BASIC REFERENCE SYSTEM.  THE SUN VECTOR S IS</span>
033335,000024:                                                                                                  <span class="co">#  LOCATED VIA TWO ANGLES.  THE FIRST ANGLE (OBLIQUITY) IS THE ANGLE BETWEEN THE EARTH EQUATOR AND THE ECLIPTIC. THE</span>
033336,000025:                                                                                                  <span class="co">#  SECOND ANGLE IS THE LONGITUDE OF THE SUN MEASURED IN THE ECLIPTIC.</span>
033337,000026:                                                                                                  <span class="co">#  THE POSITION VECTOR OF THE SUN IS</span>
033338,000027:                                                                                                  <span class="co">#        -</span>
033339,000028:                                                                                                  <span class="co">#        S = (COS(LOS), COS(OBL)*SIN(LOS), SIN(OBL)*SIN(LOS)), WHERE</span>
033340,000029: 
033341,000030:                                                                                                  <span class="co">#        LOS = LOS +LOS *T-(C *SIN(2PI*T)/365.24 +C *COS(2PI*T)/365.24)</span>
033342,000031:                                                                                                  <span class="co">#                 0    R     0                     1</span>
033343,000032:                                                                                                  <span class="co">#        LOS  (RAD) IS THE LONGITUDE OF THE SUN FOR MIDNIGHT JUNE 30TH OF THE PARTICULAR YEAR.</span>
033344,000033:                                                                                                  <span class="co">#           0</span>
033345,000034:                                                                                                  <span class="co">#        LOS  (RAD/DAY) IS THE MEAN RATE FOR THE PARTICULAR YEAR.</span>
033346,000035:                                                                                                  <span class="co">#           R</span>
033347,000036: 
033348,000037:                                                                                                  <span class="co">#  LOS  AND LOS  ARE STORED AS LOSC AND LOSR IN RATESP.</span>
033349,000038:                                                                                                  <span class="co">#     0        R</span>
033350,000039:                                                                                                  <span class="co">#  COS(OBL) AND SIN(OBL) ARE STORED IN THE MATRIX KONMAT.</span>
033351,000040: 
033352,000041:                                                                                                  <span class="co">#  T, TIME MEASURED IN DAYS (24 HOURS), IS STORED IN TIMEP.</span>
033353,000042: 
033354,000043:                                                                                                  <span class="co">#  C  AND C  ARE FUDGE FACTORS TO MINIMIZE THE DEVIATION.  THEY ARE STORED AS ONE CONSTANT (CMOD), SINCE</span>
033355,000044:                                                                                                  <span class="co">#   0      1                               2  2 1/2</span>
033356,000045:                                                                                                  <span class="co">#  C *SIN(X)+C *COS(X) CAN BE WRITTEN AS (C +C )   *SIN(X+PHI), WHERE PHI=ARCTAN(C /C ).</span>
033357,000046:                                                                                                  <span class="co">#   0         1                            0  1                                   1  0</span>
033358,000047: 
033359,000048:                                                                                                  <span class="co">#  THE MOON IS LOCATED VIA FOUR ANGLES. THE FIRST IS THE OBLIQUITY. THE SECOND IS THE MEAN LONGITUDE OF THE MOON,</span>
033360,000049:                                                                                                  <span class="co">#  MEASURED IN THE ECLIPTIC FROM THE MEAN EQUINOX TO THE MEAN ASCENDING NODE OF THE LUNAR ORBIT, AND THEN ALONG THE</span>
033361,000050:                                                                                                  <span class="co">#  ORBIT.  THE THIRD ANGLE IS THE ANGLE BETWEEN THE ECLIPTIC AND THE LUNAR ORBIT.  THE FOURTH ANGLE IS THE LONGITUDE</span>
033362,000051:                                                                                                  <span class="co">#  OF THE NODE OF THE MOON, MEASURED IN THE LUNAR ORBIT.  LET THESE ANGLES BE OBL,LOM,IM, AND LON RESPECTIVELY.</span>
033363,000052: 
033364,000053:                                                                                                  <span class="co">#  THE SIMPLIFIED POSITION VECTOR OF THE MOON IS</span>
033365,000054:                                                                                                  <span class="co">#        -</span>
033366,000055:                                                                                                  <span class="co">#        M=(COS(LOM), COS(OBL)*SIN(LOM)-SIN(OBL)*SIN(IM)*SIN(LOM-LON), SIN(OBL)*SIN(LOM)+COS(OBL)*SIN(IM)*SIN(LOM-LON))</span>
033367,000056: 
033368,000057:                                                                                                  <span class="co">#  WHERE</span>
033369,000058:                                                                                                  <span class="co">#        LOM=LOM +LOM *T-(A *SIN 2PI*T/27.5545+A *COS(2PI*T/27.5545)+B *SIN 2PI*T/32+B *COS(2PI*T/32)), AND</span>
033370,000059:                                                                                                  <span class="co">#               0    R     0                    1                     0               1</span>
033371,000060:                                                                                                  <span class="co">#        LON=LON +LON</span>
033372,000061:                                                                                                  <span class="co">#               0    R</span>
033373,000062:                                                                                                  <span class="co">#  A , A , B  AND B  ARE STORED AS AMOD AND BMOD (SEE DESCRIPTION OF CMOD, ABOVE).  COS(OBL), SIN(OBL)*SIN(IM),</span>
033374,000063:                                                                                                  <span class="co">#   0   1   0      1</span>
033375,000064:                                                                                                  <span class="co">#  SIN(OBL), AND COS(OBL)*SIN(IM) ARE STORED IN KONMAT AS K1, K2, K3  AND K4, RESPECTIVELY.  LOM , LOM , LON , LON</span>
033376,000065:                                                                                                  <span class="co">#  ARE STORED AS LOMO, LOMR, LONO, AND LONR IN RATESP.                                          0     R     0     R</span>
033377,000066: 
033378,000067:                                                                                                  <span class="co">#  THE THREE PHIS ARE STORED AS AARG, BARG, AND CARG(SUN).  ALL CONSTANTS ARE UPDATED BY YEAR.</span>
033379,000068: 
033380,000069:                                                                                                  <span class="co">#  CALLING SEQUENCE</span>
033381,000070:                                                                                                  <span class="co">#        CALL LSPOS.  RETURN IS VIA CPRET.</span>
033382,000071: 
033383,000072:                                                                                                  <span class="co">#  ALARMS OR ABORTS</span>
033384,000073:                                                                                                  <span class="co">#        NONE</span>
033385,000074: 
033386,000075:                                                                                                  <span class="co">#  ERASABLE INITIALIZATION REQUIRED</span>
033387,000076:                                                                                                  <span class="co">#        TEPHEM - TIME FROM MIDNIGHT 1 JULY PRECEDING THE LAUNCH TO THE TIME OF THE LAUNCH (WHEN THE AGC CLOCK WENT</span>
033388,000077:                                                                                                  <span class="co">#        TO ZERO).  TEPHEM IS TP WITH UNITS OF CENTI-SECONDS.</span>
033389,000078: 
033390,000079:                                                                                                  <span class="co">#        TIME2 AND TIME1 ARE IN MPAC AND MPAC +1 WHEN PROGRAM IS CALLED.</span>
033391,000080: 
033392,000081:                                                                                                  <span class="co">#  OUTPUT</span>
033393,000082:                                                                                                  <span class="co">#        UNIT POSITIONAL VECTOR OF SUN IN VSUN.  (SCALED B-1)</span>
033394,000083:                                                                                                  <span class="co">#        UNIT POSITIONAL VECTOR OF MOON IN VMOON.  (SCALED B-1)</span>
033395,000084: 
033396,000085:                                                                                                  <span class="co">#  SUBROUTINES USED</span>
033397,000086:                                                                                                  <span class="co">#        NONE</span>
033398,000087: 
033399,000088:                                                                                                  <span class="co">#  DEBRIS</span>
033400,000089:                                                                                                  <span class="co">#        CURRENT CORE SET, WORK AREA AND FREEFLAG</span>
033401,000090: 
033402,000091: 04,3206                                           <span class="ps">BANK    </span> 04                                    
033403,000092: 26,2000                                           <span class="ps">SETLOC  </span> <a href="TAGS_FOR_RELATIVE_SETLOC_AND_BLANK_BANK_CARDS.agc.html#455048454D">EPHEM</a>                                 
033404,000093: 26,2000                                           <span class="ps">BANK    </span>                                       
033405,000094: 
033406,000095: 26,2034  E5,1724                                  <span class="ps">EBANK=  </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#5653554E">VSUN</a>                                  
033407,000096: 26,2034                                           <span class="ps">COUNT*  </span> $$/<a href="TAGS_FOR_RELATIVE_SETLOC_AND_BLANK_BANK_CARDS.agc.html#455048454D">EPHEM</a>                              
033408,000097: 
<a name="4C53504F53"></a>033409,000098: 26,2034           54201        <span class="sm">LSPOS   </span>           <span class="in">SETPD   </span> <span class="in">SR        </span>                            
033410,000099: 26,2035           00001                                    0                                     
033411,000100: 26,2036           20617                                    14D                                   <span class="co">#  TP</span>
033412,000101: 26,2037           56371                           <span class="in">TAD     </span> <span class="in">DDV       </span>                            
033413,000102: 26,2040           01701                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#54455048454D">TEPHEM</a>                                <span class="co">#  TIME OF LAUNCH</span>
033414,000103: 26,2041           14076                                    <a href="#4353544F444159">CSTODAY</a>                               <span class="co">#  24 HOURS-8640000 CENTI-SECS/DAY B-33</span>
033415,000104: 26,2042           41206                           <span class="in">PUSH    </span> <span class="in">DMP       </span>                            <span class="co">#  T IN DAYS</span>
033416,000105: 26,2043           14074                                    <a href="#4B4F4D45474143">KOMEGAC</a>                               
033417,000106: 26,2044           43261                           <span class="in">SL      </span> <span class="in">DAD       </span>                            
033418,000107: 26,2045           20212                                    9D                                    
033419,000108: 26,2046           02013                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#43415247">CARG</a>                                  
033420,000109: 26,2047           41356                           <span class="in">SIN     </span> <span class="in">DMP       </span>                            
033421,000110: 26,2050           02011                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#434D4F44">CMOD</a>                                  
033422,000111: 26,2051           77725                           <span class="in">PDDL    </span>                                       
033423,000112: 26,2052           54205                           <span class="in">DMP     </span> <span class="in">SL        </span>                            
033424,000113: 26,2053           14072                                    <a href="#4C4F5352">LOSR</a>                                  
033425,000114: 26,2054           20207                                    6                                     
033426,000115: 26,2055           45215                           <span class="in">DAD     </span> <span class="in">DSU       </span>                            
033427,000116: 26,2056           02007                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#4C4F534F">LOSO</a>                                  
033428,000117: 26,2057           73406                           <span class="in">PUSH    </span> <span class="in">SIN       </span>                            
033429,000118: 26,2060           41206                           <span class="in">PUSH    </span> <span class="in">DMP       </span>                            
033430,000119: 26,2061           14102                                    <a href="#4B4F4E4D415433">KONMAT3</a>                               
033431,000120: 26,2062           65352                           <span class="in">SL1     </span> <span class="in">PDDL      </span>                            
033432,000121: 26,2063           72405                           <span class="in">DMP     </span> <span class="in">SL1       </span>                            
033433,000122: 26,2064           14100                                    <a href="#4B4F4E4D415431">KONMAT1</a>                               
033434,000123: 26,2065           71525                           <span class="in">PDDL    </span> <span class="in">COS       </span>                            
033435,000124: 26,2066           00001                                    0                                     
033436,000125: 26,2067           53466                           <span class="in">VDEF    </span> <span class="in">UNIT      </span>                            
033437,000126: 26,2070           43406                           <span class="in">PUSH    </span> <span class="in">RVQ       </span>                            
033438,000127: 
<a name="4C4F5352"></a>033439,000128: 26,2071           01315 26267  <span class="sm">LOSR    </span>           <span class="ps">2DEC*   </span> .00273780317 B+4*                       
<a name="4B4F4D45474143"></a>033440,000129: 26,2073           00131 26612  <span class="sm">KOMEGAC </span>           <span class="ps">2DEC*   </span> .00273777859 B+1*                       
<a name="4353544F444159"></a>033441,000130: 26,2075           00040 36540  <span class="sm">CSTODAY </span>           <span class="ps">2DEC    </span> 8640000    B-32                       
<a name="4B4F4E4D415431"></a>033442,000131: 26,2077           16533 32024  <span class="sm">KONMAT1 </span>           <span class="ps">2DEC*   </span> .91745773  B-1*                       
<a name="4B4F4E4D415433"></a>033443,000132: 26,2101           06273 01466  <span class="sm">KONMAT3 </span>           <span class="ps">2DEC*   </span> .397833274 B-1*                       

End of include-file LUNAR_AND_SOLAR_EPHEMERIDES_SUBROUTINES.agc.  Parent file is <a href="MAIN.agc.html">MAIN.agc</a>
</pre>
</span>
</p>
</body>
</html>
