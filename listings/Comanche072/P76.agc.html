<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
<title>Assembly listing generated by yaYUL</title>
<style type="text/css">
p.nobreak { white-space:nowrap; }
a { text-decoration:none; }
</style>
<style type="text/css">
.op{
font-weight: bold;
color: #993300;
}
</style>
<style type="text/css">
.dn{
color: #009900;
}
</style>
<style type="text/css">
.fe{
color: #FF0000;
}
</style>
<style type="text/css">
.in{
color: #FF6600;
}
</style>
<style type="text/css">
.ps{
color: #336600;
}
</style>
<style type="text/css">
.sm{
color: #0000FF;
}
</style>
<style type="text/css">
.wn{
color: #FF9900;
}
</style>
<style type="text/css">
.co{
font-style: italic;
color: #993399;
}
</style>
</head>
<body>
<p class="nobreak">
<span style="font-family: monospace;">
<pre>
<h1>Source Code</h1>
</pre>
</span>
</p>
<table style="text-align: left;" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="white-space: nowrap; vertical-align: middle;">
<img alt="" src="Apollo32.png" style="width: 32px; height: 32px;" align="left">
</td>
<td style="vertical-align: middle;">
These source-code files are part of a reconstructed copy of Comanche 72, the
first release of the Apollo Guidance Computer (AGC) Command Module (CM) software
for Apollo 13.
<br><br>
They have been adapted from sources files created from a listing of Comanche 55.
These source files were updated to match binary dumps of a set of Comanche 67 rope modules.
They were then further modified by applying known changes between Comanche 67 and Comanche 72.
A binary dump of module B2 of Comanche 72, part number 2010802-021, was also used
to validate changes made to banks 05-13. The resulting code assembles to have identical
memory-bank checksums as those specified in NASA drawing 2021153G; this gives reasonably
high confidence that the changes that have been made are correct. In places where
ambiguity exists, this ambiguity is discussed in "## Reconstruction:" comments.
<br><br>
Since no contemporary listings of Comanche 72 are available as source material, 
all comments and labels are approximate.
They have been taken from other AGC programs where possible, or, in some places, written
from scratch to match what we believe would have been in the original listing.
</td></tr></tbody></table>

<p class="nobreak">
<span style="font-family: monospace;">
<pre>
021440,000002:                                                                                                  <span class="co">## Copyright:   Public domain.</span>
021441,000003:                                                                                                  <span class="co">## Filename:    P76.agc</span>
021442,000004:                                                                                                  <span class="co">## Purpose:     A section of Comanche revision 072.</span>
021443,000005:                                                                                                  <span class="co">##              It is part of the reconstructed source code for the first</span>
021444,000006:                                                                                                  <span class="co">##              release of the software for the Command Module's (CM) Apollo</span>
021445,000007:                                                                                                  <span class="co">##              Guidance Computer (AGC) for Apollo 13. No original listings</span>
021446,000008:                                                                                                  <span class="co">##              of this program are available; instead, this file was recreated</span>
021447,000009:                                                                                                  <span class="co">##              from a printout of Comanche 055, binary dumps of a set of</span>
021448,000010:                                                                                                  <span class="co">##              Comanche 067 rope modules, and changelogs between Comanche 067</span>
021449,000011:                                                                                                  <span class="co">##              and 072. It has been adapted such that the resulting bugger words</span>
021450,000012:                                                                                                  <span class="co">##              exactly match those specified for Comanche 072 in NASA drawing</span>
021451,000013:                                                                                                  <span class="co">##              2021153G, which gives relatively high confidence that the</span>
021452,000014:                                                                                                  <span class="co">##              reconstruction is correct.</span>
021453,000015:                                                                                                  <span class="co">## Assembler:   yaYUL</span>
021454,000016:                                                                                                  <span class="co">## Contact:     Ron Burkey &lt;info@sandroid.org>.</span>
021455,000017:                                                                                                  <span class="co">## Website:     www.ibiblio.org/apollo/index.html</span>
021456,000018:                                                                                                  <span class="co">## Mod history: 2024-05-13 MAS  Created from Comanche 067.</span>
021457,000019:                                                                                                  <span class="co">##              2024-05-14 MAS  Implemented PCR-863.1, "Make P76 set NODO flag".</span>
021458,000020: 
021459,000021:                                                                                                  <span class="co">#  1)    PROGRAM NAME - TARGET DELTA V PROGRAM (P76).</span>
021460,000022:                                                                                                  <span class="co">#  2)    FUNCTIONAL DESCRIPTION - UPON ENTRY BY ASTRONAUT ACTION, P76 FLASHES DSKY REQUESTS TO THE ASTRONAUT</span>
021461,000023:                                                                                                  <span class="co">#        TO PROVIDE VIA DSKY (1) THE DELTA V TO BE APPLIED TO THE OTHER VEHICLE STATE VECTOR AND (2) THE</span>
021462,000024:                                                                                                  <span class="co">#        TIME (TIG) AT WHICH THE OTHER VEHICLE VELOCITY WAS CHANGED BY EXECUTION OF A THRUSTING MANEUVER. THE</span>
021463,000025:                                                                                                  <span class="co">#        OTHER VEHICLE STATE VECTOR IS INTEGRATED TO TIG AND UPDATED BY THE ADDITION OF DELTA V (DELTA V HAVING</span>
021464,000026:                                                                                                  <span class="co">#        BEEN TRANSFORMED FROM LV TO REF COSYS).  USING INTEGRVS, THE PROGRAM THEN INTEGRATES THE OTHER</span>
021465,000027:                                                                                                  <span class="co">#        VEHICLE STATE VECTOR TO THE STATE VECTOR OF THIS VEHICLE, THUS INSURING THAT THE W-MATRIX AND BOTH VEHICLE</span>
021466,000028:                                                                                                  <span class="co">#        STATES CORRESPOND TO THE SAME TIME.</span>
021467,000029:                                                                                                  <span class="co">#  3)    ERASABLE INITIALIZATION REQUIRED - NONE.</span>
021468,000030:                                                                                                  <span class="co">#  4)    CALLING SEQUENCES AND EXIT MODES - CALLED BY ASTRONAUT REQUEST THRU DSKY V 37 E 76E.</span>
021469,000031:                                                                                                  <span class="co">#        EXITS BY TCF ENDOFJOB.</span>
021470,000032:                                                                                                  <span class="co">#  5)    OUTPUT - OTHER VEHICLE STATE VECTOR INTEGRATED TO TIG AND INCREMENTED BY DELTA V IN REF COSYS.</span>
021471,000033:                                                                                                  <span class="co">#        THE PUSHLIST CONTAINS THE MATRIX BY WHICH THE INPUT DELTA V MUST BE POST-MULTIPLIED TO CONVERT FROM LV</span>
021472,000034:                                                                                                  <span class="co">#        TO REF COSYS.</span>
021473,000035:                                                                                                  <span class="co">#  6)    DEBRIS - OTHER VEHICLE STATE VECTOR.</span>
021474,000036:                                                                                                  <span class="co">#  7)    SUBROUTINES CALLED - BANKCALL, GOXDSPF, CSMPREC (OR LEMPREC), ATOPCSM (OR ATOPLEM), INTSTALL, INTWAKE, PHASCHNG</span>
021475,000037:                                                                                                  <span class="co">#        INTPRET, INTEGRVS, AND MINIRECT.</span>
021476,000038:                                                                                                  <span class="co">#  8)    FLAG USE - MOONFLAG, CMOONFLAG, INTYPFLG, RASFLAG, AND MARKCTR.</span>
021477,000039: 
021478,000040: 30,2000                                           <span class="ps">BANK    </span> 30                                    
021479,000041: 13,2000                                           <span class="ps">SETLOC  </span> <a href="TAGS_FOR_RELATIVE_SETLOC_AND_BLANK_BANK_CARDS.agc.html#5037364C4F43">P76LOC</a>                                
021480,000042: 13,2000                                           <span class="ps">BANK    </span>                                       
021481,000043: 
021482,000044: 13,2071                                           <span class="ps">COUNT*  </span> $$/<a href="#503736">P76</a>                                
021483,000045: 
021484,000046: 13,2071  E7,1412                                  <span class="ps">EBANK=  </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#544947">TIG</a>                                   
021485,000047: 
<a name="503736"></a>021486,000048: 13,2071           05562        <span class="sm">P76     </span>           <span class="op">TC      </span> <a href="SERVICE_ROUTINES.agc.html#5550464C4147">UPFLAG</a>                                
021487,000049: 13,2072           00031                           <span class="ps">ADRES   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#545241434B464C47">TRACKFLG</a>                              
021488,000050: 
021489,000051: 13,2073           32217                           <span class="op">CAF     </span> <a href="#5630364E3834">V06N84</a>     +1                         <span class="co">#  FLASH VERB 06 NOUN 33, DISPLAY LAST TIG,</span>
021490,000052: 13,2074           04676                           <span class="op">TC      </span> <a href="INTER-BANK_COMMUNICATION.agc.html#42414E4B43414C4C">BANKCALL</a>                              <span class="co">#  AND WAIT FOR KEYBOARD ACTION.</span>
021491,000053: 13,2075           20720                           <span class="ps">CADR    </span> <a href="DISPLAY_INTERFACE_ROUTINES.agc.html#474F464C415348">GOFLASH</a>                               
021492,000054: 13,2076           12210                           <span class="op">TCF     </span> <a href="#454E44503736">ENDP76</a>                                
021493,000055: 13,2077           02101                           <span class="op">TC      </span> +2                                    <span class="co">#  PROCEED</span>
021494,000056: 13,2100           02073                           <span class="op">TC      </span> -5                                    <span class="co">#  STORE DATA AND REPEAT FLASHING</span>
021495,000057: 13,2101           32216                           <span class="op">CAF     </span> <a href="#5630364E3834">V06N84</a>                                <span class="co">#  FLASH LAST DELTA V,</span>
021496,000058: 13,2102           04676                           <span class="op">TC      </span> <a href="INTER-BANK_COMMUNICATION.agc.html#42414E4B43414C4C">BANKCALL</a>                              <span class="co">#  AND WAIT FOR KEYBOARD ACTION.</span>
021497,000059: 13,2103           20720                           <span class="ps">CADR    </span> <a href="DISPLAY_INTERFACE_ROUTINES.agc.html#474F464C415348">GOFLASH</a>                               
021498,000060: 13,2104           12210                           <span class="op">TCF     </span> <a href="#454E44503736">ENDP76</a>                                
021499,000061: 13,2105           02107                           <span class="op">TC      </span> +2                                    
021500,000062: 13,2106           02101                           <span class="op">TC      </span> -5                                    
021501,000063: 13,2107           06006                           <span class="op">TC      </span> <a href="INTERPRETER.agc.html#494E5450524554">INTPRET</a>                               <span class="co">#  RETURN TO INTERPRETIVE CODE</span>
</pre>
</span>
</p>
<table style="text-align: left;" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="white-space: nowrap; vertical-align: middle;">
<img alt="" src="Apollo32.png" style="width: 32px; height: 32px;" align="left">
</td>
<td style="vertical-align: middle;">
<b>Reconstruction:</b> The setting of NODOFLAG here was added to Comanche 72
as part of PCR-863.1, "Make P76 set NODO flag".
</td></tr></tbody></table>
<p class="nobreak">
<span style="font-family: monospace;">
<pre>
021504,000066: 13,2110           43145                           <span class="in">DLOAD   </span> <span class="in">SET       </span>                            <span class="co">#  SET D(MPAC)=TIG IN CSEC B28</span>
021505,000067: 13,2111           03413                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#544947">TIG</a>                                   
021506,000068: 13,2112           01076                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#4E4F444F464C4147">NODOFLAG</a>                              <span class="co">#  DISALLOW V37</span>
021507,000069: 13,2113           34041                           <span class="in">STCALL  </span> <a href="ORBITAL_INTEGRATION.agc.html#5444454331">TDEC1</a>                                 <span class="co">#  SET TDEC1=TIG FOR ORBITAL INTEGRATION</span>
021508,000070: 13,2114           27114                                    <a href="TAGS_FOR_RELATIVE_SETLOC_AND_BLANK_BANK_CARDS.agc.html#4F544850524543">OTHPREC</a>                               
<a name="434F4D504D4154"></a>021509,000071: 13,2115           53575        <span class="sm">COMPMAT </span>           <span class="in">VLOAD   </span> <span class="in">UNIT      </span>                            
021510,000072: 13,2116           00001                                    <a href="ORBITAL_INTEGRATION.agc.html#52415454">RATT</a>                                  
021511,000073: 13,2117           77676                           <span class="in">VCOMP   </span>                                       <span class="co">#  U(-R)</span>
021512,000074: 13,2120           00031                           <span class="in">STORE   </span> 24D                                   <span class="co">#  U(-R) TO 24D</span>
021513,000075: 13,2121           53435                           <span class="in">VXV     </span> <span class="in">UNIT      </span>                            <span class="co">#  U(-R) X V = U(V X R)</span>
021514,000076: 13,2122           00007                                    <a href="ORBITAL_INTEGRATION.agc.html#56415454">VATT</a>                                  
021515,000077: 13,2123           00023                           <span class="in">STORE   </span> 18D                                   
021516,000078: 13,2124           53435                           <span class="in">VXV     </span> <span class="in">UNIT      </span>                            <span class="co">#  U(V X R) X U(-R) = U((R X V) X R)</span>
021517,000079: 13,2125           00031                                    24D                                   
021518,000080: 13,2126           24015                           <span class="in">STOVL   </span> 12D                                   
021519,000081: 13,2127           03540                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#44454C564F56">DELVOV</a>                                
021520,000082: 13,2130           76505                           <span class="in">VXM     </span> <span class="in">VSL1      </span>                            <span class="co">#  V(MPAC)=DELTA V IN REFCOSYS</span>
021521,000083: 13,2131           00015                                    12D                                   
021522,000084: 13,2132           77655                           <span class="in">VAD     </span>                                       
021523,000085: 13,2133           00007                                    <a href="ORBITAL_INTEGRATION.agc.html#56415454">VATT</a>                                  
021524,000086: 13,2134           00007                           <span class="in">STORE   </span> 6                                     <span class="co">#  V(PD6)=VATT + DELTA V</span>
021525,000087: 13,2135           77624                           <span class="in">CALL    </span>                                       <span class="co">#  PREVENT WOULD-BE USER OF ORBITAL</span>
021526,000088: 13,2136           27446                                    <a href="INTEGRATION_INITIALIZATION.agc.html#494E545354414C4C">INTSTALL</a>                              <span class="co">#  INTEG FROM INTERFERING WITH UPDATING</span>
021527,000089: 13,2137           77624                           <span class="in">CALL    </span>                                       
021528,000090: 13,2140           26220                                    <a href="#50373653554231">P76SUB1</a>                               
021529,000091: 13,2141           53775                           <span class="in">VLOAD   </span> <span class="in">VSR*      </span>                            
021530,000092: 13,2142           00007                                    6                                     
021531,000093: 13,2143           57176                                    0,2                                   
021532,000094: 13,2144           25543                           <span class="in">STOVL   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#564356">VCV</a>                                   
021533,000095: 13,2145           00001                                    <a href="ORBITAL_INTEGRATION.agc.html#52415454">RATT</a>                                  
021534,000096: 13,2146           77657                           <span class="in">VSR*    </span>                                       
021535,000097: 13,2147           57176                                    0,2                                   
021536,000098: 13,2150           15535                           <span class="in">STODL   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#524356">RCV</a>                                   
021537,000099: 13,2151           03413                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#544947">TIG</a>                                   
021538,000100: 13,2152           01517                           <span class="in">STORE   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#544554">TET</a>                                   
021539,000101: 13,2153           71214                           <span class="in">CLEAR   </span> <span class="in">DLOAD     </span>                            
021540,000102: 13,2154           01673                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#494E545950464C47">INTYPFLG</a>                              
021541,000103: 13,2155           01571                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#54455454484953">TETTHIS</a>                               
<a name="494E544F54484953"></a>021542,000104: 13,2156           34041        <span class="sm">INTOTHIS</span>           <span class="in">STCALL  </span> <a href="ORBITAL_INTEGRATION.agc.html#5444454331">TDEC1</a>                                 
021543,000105: 13,2157           27144                                    <a href="INTEGRATION_INITIALIZATION.agc.html#494E544547525653">INTEGRVS</a>                              
021544,000106: 13,2160           77624                           <span class="in">CALL    </span>                                       
021545,000107: 13,2161           27446                                    <a href="INTEGRATION_INITIALIZATION.agc.html#494E545354414C4C">INTSTALL</a>                              
021546,000108: 13,2162           77624                           <span class="in">CALL    </span>                                       
021547,000109: 13,2163           26220                                    <a href="#50373653554231">P76SUB1</a>                               <span class="co">#  SET/CLEAR MOONFLAG</span>
021548,000110: 13,2164           77775                           <span class="in">VLOAD   </span>                                       
021549,000111: 13,2165           00017                                    <a href="ORBITAL_INTEGRATION.agc.html#5241545431">RATT1</a>                                 
021550,000112: 13,2166           01503                           <span class="in">STORE   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#5252454354">RRECT</a>                                 
021551,000113: 13,2167           15535                           <span class="in">STODL   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#524356">RCV</a>                                   
021552,000114: 13,2170           00015                                    <a href="ORBITAL_INTEGRATION.agc.html#544154">TAT</a>                                   
021553,000115: 13,2171           25517                           <span class="in">STOVL   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#544554">TET</a>                                   
021554,000116: 13,2172           00025                                    <a href="ORBITAL_INTEGRATION.agc.html#5641545431">VATT1</a>                                 
021555,000117: 13,2173           77624                           <span class="in">CALL    </span>                                       
021556,000118: 13,2174           23417                                    <a href="ORBITAL_INTEGRATION.agc.html#4D494E4952454354">MINIRECT</a>                              
021557,000119: 13,2175           77776                           <span class="in">EXIT    </span>                                       
021558,000120: 13,2176           05426                           <span class="op">TC      </span> <a href="PHASE_TABLE_MAINTENANCE.agc.html#5048415343484E47">PHASCHNG</a>                              
021559,000121: 13,2177           04024                           <span class="ps">OCT     </span> 04024                                 
</pre>
</span>
</p>
<table style="text-align: left;" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="white-space: nowrap; vertical-align: middle;">
<img alt="" src="Apollo32.png" style="width: 32px; height: 32px;" align="left">
</td>
<td style="vertical-align: middle;">
<b>Reconstruction:</b> The code below, down to ENDP76, was rewritten for
Comanche 72 as part of PCR-863.1, "Make P76 set NODO flag". The setting of
REINTFLG was moved from basic to interpretive, the basic call to INTWAKE1
was changed to an interpretive call to INTWAKE0, and OUT was changed to
clear NODOFLAG.
</td></tr></tbody></table>
<p class="nobreak">
<span style="font-family: monospace;">
<pre>
021565,000127: 13,2200           06006                           <span class="op">TC      </span> <a href="INTERPRETER.agc.html#494E5450524554">INTPRET</a>                               
021566,000128: 13,2201           45014                           <span class="in">SET     </span> <span class="in">CALL      </span>                            
021567,000129: 13,2202           05070                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#5245494E54464C47">REINTFLG</a>                              
021568,000130: 13,2203           26767                                    <a href="TAGS_FOR_RELATIVE_SETLOC_AND_BLANK_BANK_CARDS.agc.html#41544F504F5448">ATOPOTH</a>                               
021569,000131: 13,2204           77624                           <span class="in">CALL    </span>                                       
021570,000132: 13,2205           27461                                    <a href="INTEGRATION_INITIALIZATION.agc.html#494E5457414B4530">INTWAKE0</a>                              <span class="co">#  PERMIT USE OF ORBITAL INTEGRATION</span>
<a name="4F5554"></a>021571,000133: 13,2206           77414        <span class="sm">OUT     </span>           <span class="in">CLEAR   </span> <span class="in">EXIT      </span>                            <span class="co">#  ALLOW V37, NO NEED TO CLEAR NODOFLAG AT</span>
021572,000134: 13,2207           01276                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#4E4F444F464C4147">NODOFLAG</a>                              <span class="co">#   ENDP76 SINCE FLAG NOT SET WHEN DISPLAY</span>
021573,000135:                                                                                                  <span class="co">#   RESPONSES TRANSFER THERE FROM P76+.</span>
<a name="454E44503736"></a>021574,000136: 13,2210           35035        <span class="sm">ENDP76  </span>           <span class="op">CAF     </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#5A45524F">ZERO</a>                                  
021575,000137: 13,2211           55126                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4D41524B435452">MARKCTR</a>                               <span class="co">#  CLEAR RR TRACKING MARK COUNTER</span>
021576,000138: 13,2212           55125                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#564846434E54">VHFCNT</a>                                
021577,000139: 
021578,000140: 13,2213           37716                           <span class="op">CAF     </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#4E45474F4E45">NEGONE</a>                                
021579,000141: 13,2214           55734                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4D524B42554632">MRKBUF2</a>                               <span class="co">#  INVALIDATE MARK BUFFER</span>
021580,000142: 
021581,000143: 13,2215           14106                           <span class="op">TCF     </span> <a href="FRESH_START_AND_RESTART.agc.html#474F544F504F4F48">GOTOPOOH</a>                              
021582,000144: 
<a name="5630364E3834"></a>021583,000145: 13,2216           01524        <span class="sm">V06N84  </span>           <span class="ps">NV      </span> 0684                                  
021584,000146: 13,2217           01441                           <span class="ps">NV      </span> 0633                                  
<a name="50373653554231"></a>021585,000147: 13,2220           67214        <span class="sm">P76SUB1 </span>           <span class="in">CLEAR   </span> <span class="in">SLOAD     </span>                            
021586,000148: 13,2221           00263                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#4D4F4F4E464C4147">MOONFLAG</a>                              
021587,000149: 13,2222           00050                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#5832">X2</a>                                    
021588,000150: 13,2223           43030                           <span class="in">BHIZ    </span> <span class="in">SET       </span>                            <span class="co">#  X2=0...CLEAR MOONFLAG</span>
021589,000151: 13,2224           26226                                    +2                                    <span class="co">#    =2.....SET MOONFLAG</span>
021590,000152: 13,2225           00063                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#4D4F4F4E464C4147">MOONFLAG</a>                              
021591,000153: 13,2226           77616                           <span class="in">RVQ     </span>                                       
021592,000154: 

End of include-file P76.agc.  Parent file is <a href="MAIN.agc.html">MAIN.agc</a>
</pre>
</span>
</p>
</body>
</html>
