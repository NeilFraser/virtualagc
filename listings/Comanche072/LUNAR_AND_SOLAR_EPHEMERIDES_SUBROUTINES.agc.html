<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
<title>Assembly listing generated by yaYUL</title>
<style type="text/css">
p.nobreak { white-space:nowrap; }
a { text-decoration:none; }
</style>
<style type="text/css">
.op{
font-weight: bold;
color: #993300;
}
</style>
<style type="text/css">
.dn{
color: #009900;
}
</style>
<style type="text/css">
.fe{
color: #FF0000;
}
</style>
<style type="text/css">
.in{
color: #FF6600;
}
</style>
<style type="text/css">
.ps{
color: #336600;
}
</style>
<style type="text/css">
.sm{
color: #0000FF;
}
</style>
<style type="text/css">
.wn{
color: #FF9900;
}
</style>
<style type="text/css">
.co{
font-style: italic;
color: #993399;
}
</style>
</head>
<body>
<p class="nobreak">
<span style="font-family: monospace;">
<pre>
<h1>Source Code</h1>
</pre>
</span>
</p>
<table style="text-align: left;" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="white-space: nowrap; vertical-align: middle;">
<img alt="" src="Apollo32.png" style="width: 32px; height: 32px;" align="left">
</td>
<td style="vertical-align: middle;">
These source-code files are part of a reconstructed copy of Comanche 72, the
first release of the Apollo Guidance Computer (AGC) Command Module (CM) software
for Apollo 13.
<br><br>
They have been adapted from sources files created from a listing of Comanche 55.
These source files were updated to match binary dumps of a set of Comanche 67 rope modules.
They were then further modified by applying known changes between Comanche 67 and Comanche 72.
A binary dump of module B2 of Comanche 72, part number 2010802-021, was also used
to validate changes made to banks 05-13. The resulting code assembles to have identical
memory-bank checksums as those specified in NASA drawing 2021153G; this gives reasonably
high confidence that the changes that have been made are correct. In places where
ambiguity exists, this ambiguity is discussed in "## Reconstruction:" comments.
<br><br>
Since no contemporary listings of Comanche 72 are available as source material, 
all comments and labels are approximate.
They have been taken from other AGC programs where possible, or, in some places, written
from scratch to match what we believe would have been in the original listing.
</td></tr></tbody></table>

<p class="nobreak">
<span style="font-family: monospace;">
<pre>
033830,000002:                                                                                                  <span class="co">## Copyright:   Public domain.</span>
033831,000003:                                                                                                  <span class="co">## Filename:    LUNAR_AND_SOLAR_EPHEMERIDES_SUBROUTINES.agc</span>
033832,000004:                                                                                                  <span class="co">## Purpose:     A section of Comanche revision 072.</span>
033833,000005:                                                                                                  <span class="co">##              It is part of the reconstructed source code for the first</span>
033834,000006:                                                                                                  <span class="co">##              release of the software for the Command Module's (CM) Apollo</span>
033835,000007:                                                                                                  <span class="co">##              Guidance Computer (AGC) for Apollo 13. No original listings</span>
033836,000008:                                                                                                  <span class="co">##              of this program are available; instead, this file was recreated</span>
033837,000009:                                                                                                  <span class="co">##              from a printout of Comanche 055, binary dumps of a set of</span>
033838,000010:                                                                                                  <span class="co">##              Comanche 067 rope modules, and changelogs between Comanche 067</span>
033839,000011:                                                                                                  <span class="co">##              and 072. It has been adapted such that the resulting bugger words</span>
033840,000012:                                                                                                  <span class="co">##              exactly match those specified for Comanche 072 in NASA drawing</span>
033841,000013:                                                                                                  <span class="co">##              2021153G, which gives relatively high confidence that the</span>
033842,000014:                                                                                                  <span class="co">##              reconstruction is correct.</span>
033843,000015:                                                                                                  <span class="co">## Assembler:   yaYUL</span>
033844,000016:                                                                                                  <span class="co">## Contact:     Ron Burkey &lt;info@sandroid.org>.</span>
033845,000017:                                                                                                  <span class="co">## Website:     www.ibiblio.org/apollo/index.html</span>
033846,000018:                                                                                                  <span class="co">## Mod history: 2024-05-13 MAS  Created from Comanche 067.</span>
033847,000019: 
033848,000020:                                                                                                  <span class="co">#  LUNAR AND SOLAR EPHEMERIDES SUBROUTINES</span>
033849,000021: 
033850,000022:                                                                                                  <span class="co">#  FUNCTIONAL DESCRIPTION</span>
033851,000023: 
033852,000024:                                                                                                  <span class="co">#        THESE SUBROUTINES ARE USED TO DETERMINE THE POSITION AND VELOCITY</span>
033853,000025:                                                                                                  <span class="co">#        VECTORS OF THE SUN AND THE MOON RELATIVE TO THE EARTH AT THE</span>
033854,000026:                                                                                                  <span class="co">#        SPECIFIED GROUND ELAPSED TIME INPUT BY THE USER.</span>
033855,000027: 
033856,000028:                                                                                                  <span class="co">#        THE POSITION OF THE MOON IS STORED IN THE COMPUTER IN THE FORM OF</span>
033857,000029:                                                                                                  <span class="co">#        A NINTH DEGREE POLYNOMIAL APPROXIMATION WHICH IS VALID OVER A 15</span>
033858,000030:                                                                                                  <span class="co">#        DAY INTERVAL BEGINNING SHORTLY BEFORE LAUNCH.  THEREFORE THE TIME</span>
033859,000031:                                                                                                  <span class="co">#        INPUT BY THE USER SHOULD FALL WITHIN THIS 15 DAY INTERVAL.</span>
033860,000032: 
033861,000033:                                                                                                  <span class="co">#        LSPOS COMPUTES THE POSITION VECTORS OF THE SUN AND THE MOON.</span>
033862,000034: 
033863,000035:                                                                                                  <span class="co">#        LUNPOS COMPUTES THE POSITION VECTOR OF THE MOON.</span>
033864,000036: 
033865,000037:                                                                                                  <span class="co">#        LUNVEL COMPUTES THE VELOCITY VECTOR OF THE MOON.</span>
033866,000038: 
033867,000039:                                                                                                  <span class="co">#        SOLPOS COMPUTES THE POSITION VECTOR OF THE SUN.</span>
033868,000040: 
033869,000041:                                                                                                  <span class="co">#  CALLING SEQUENCE</span>
033870,000042: 
033871,000043:                                                                                                  <span class="co">#        DLOAD   CALL</span>
033872,000044:                                                                                                  <span class="co">#                TIME            GROUND ELAPSED TIME</span>
033873,000045:                                                                                                  <span class="co">#                SUBROUTINE      LSPOS OR LUNPOS OR LUNVEL OR SOLPOS</span>
033874,000046: 
033875,000047:                                                                                                  <span class="co">#  INPUT</span>
033876,000048: 
033877,000049:                                                                                                  <span class="co">#        1) SPECIFIED GROUND ELAPSED TIME IN CS X B-28 LOADED IN MPAC.</span>
033878,000050: 
033879,000051:                                                                                                  <span class="co">#        2) TIMEMO - TIME AT THE CENTER OF THE RANGE OVER WHICH THE LUNAR</span>
033880,000052:                                                                                                  <span class="co">#        POSITION POLYNOMIAL IS VALID IN CS X B-42.</span>
033881,000053: 
033882,000054:                                                                                                  <span class="co">#        3) VECOEM - VECTOR COEFFICIENTS OF THE LUNAR POSITION POLYNOMIAL</span>
033883,000055:                                                                                                  <span class="co">#        LOADED IN DESCENDING SEQUENCE IN METERS/CS**N X B-2</span>
033884,000056: 
033885,000057:                                                                                                  <span class="co">#        4) RESO - POSITION VECTOR OF THE SUN RELATIVE TO THE EARTH AT</span>
033886,000058:                                                                                                  <span class="co">#        TIMEMO IN METERS X B-38.</span>
033887,000059: 
033888,000060:                                                                                                  <span class="co">#        5) VESO - VELOCITY VECTOR OF THE SUN RELATIVE TO THE EARTH AT</span>
033889,000061:                                                                                                  <span class="co">#        TIMEMO IN METERS/CS X B-9.</span>
033890,000062:                                                                                                  <span class="co">#  </span>
033891,000063:                                                                                                  <span class="co">#        6) OMEGAES - ANGULAR VELOCITY OF THE VECTOR RESO AT TIMEMO IN</span>
033892,000064:                                                                                                  <span class="co">#        REV/CS X B+26.</span>
033893,000065: 
033894,000066:                                                                                                  <span class="co">#        ALL EXCEPT THE FIRST INPUT ARE INCLUDED IN THE PRE-LAUNCH</span>
033895,000067:                                                                                                  <span class="co">#        ERASABLE DATA LOAD.</span>
033896,000068: 
033897,000069:                                                                                                  <span class="co">#  OUTPUT - LSPOS</span>
033898,000070: 
033899,000071:                                                                                                  <span class="co">#        1) 2D OF VAC AREA CONTAINS THE POSITION VECTOR OF THE SUN RELATIVE</span>
033900,000072:                                                                                                  <span class="co">#        TO THE EARTH AT TIME INPUT BY THE USER IN METERS X B-38.</span>
033901,000073: 
033902,000074:                                                                                                  <span class="co">#        2) MPAC CONTAINS THE POSITION VECTOR OF THE MOON RELATIVE TO THE</span>
033903,000075:                                                                                                  <span class="co">#        EARTH AT TIME INPUT BY THE USER IN METERS X B-29.</span>
033904,000076: 
033905,000077:                                                                                                  <span class="co">#  OUTPUT - LUNPOS</span>
033906,000078: 
033907,000079:                                                                                                  <span class="co">#        MPAC CONTAINS THE POSITION VECTOR OF THE MOON RELATIVE TO THE</span>
033908,000080:                                                                                                  <span class="co">#        EARTH AT THE TIME INPUT BY USER IN METERS X B-29.</span>
033909,000081: 
033910,000082:                                                                                                  <span class="co">#  OUTPUT - LUNVEL</span>
033911,000083: 
033912,000084:                                                                                                  <span class="co">#        MPAC CONTAINS THE VELOCITY VECTOR OF THE MOON RELATIVE TO THE</span>
033913,000085:                                                                                                  <span class="co">#        EARTH AT TIME INPUT BY THE USER IN METERS/CS X B-7.</span>
033914,000086: 
033915,000087:                                                                                                  <span class="co">#  OUTPUT - SOLPOS</span>
033916,000088: 
033917,000089:                                                                                                  <span class="co">#        MPAC CONTAINS THE POSITION VECTOR OF THE SUN RELATIVE TO THE EARTH</span>
033918,000090:                                                                                                  <span class="co">#        AT TIME INPUT BY THE USER IN METERS X B-38.</span>
033919,000091: 
033920,000092:                                                                                                  <span class="co">#  SUBROUTINES USED</span>
033921,000093: 
033922,000094:                                                                                                  <span class="co">#        NONE</span>
033923,000095: 
033924,000096:                                                                                                  <span class="co">#  REMARKS</span>
033925,000097: 
033926,000098:                                                                                                  <span class="co">#        THE VAC AREA IS USED FOR STORAGE OF INTERMEDIATE AND FINAL RESULTS</span>
033927,000099:                                                                                                  <span class="co">#        OF COMPUTATIONS.</span>
033928,000100: 
033929,000101:                                                                                                  <span class="co">#        S1, X1 AND X2 ARE USED BY THESE SUBROUTINES.</span>
033930,000102: 
033931,000103:                                                                                                  <span class="co">#        PRELAUNCH ERASABLE DATA LOAD ARE ONLY ERASABLE STORAGE USED BY</span>
033932,000104:                                                                                                  <span class="co">#        THESE SUBROUTINES.</span>
033933,000105: 
033934,000106:                                                                                                  <span class="co">#        RESTARTS DURING OPERATION OF THESE SUBROUTINES MUST BE HANDLED BY</span>
033935,000107:                                                                                                  <span class="co">#        THE USER.</span>
033936,000108: 
033937,000109: 36,2466                                           <span class="ps">BANK    </span> 36                                    
033938,000110: 26,2000                                           <span class="ps">SETLOC  </span> <a href="TAGS_FOR_RELATIVE_SETLOC_AND_BLANK_BANK_CARDS.agc.html#455048454D">EPHEM</a>                                 
033939,000111: 26,2000                                           <span class="ps">BANK    </span>                                       
033940,000112: 
033941,000113: 26,2110                                           <span class="ps">COUNT*  </span> $$/<a href="TAGS_FOR_RELATIVE_SETLOC_AND_BLANK_BANK_CARDS.agc.html#455048454D">EPHEM</a>                              
033942,000114: 26,2110  E7,1777                                  <span class="ps">EBANK=  </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#454E442D4537">END-E7</a>                                
<a name="4C53504F53"></a>033943,000115: 26,2110           77774        <span class="sm">LSPOS   </span>           <span class="in">AXT,2   </span>                                       <span class="co">#  COMPUTES POSITION VECTORS OF BOTH THE</span>
033944,000116: 26,2111           54161                                    <a href="#52455341">RESA</a>                                  <span class="co">#  SUN AND THE MOON.  THE POSITION VECTOR</span>
033945,000117: 26,2112           52170                           <span class="in">AXT,1   </span> <span class="in">GOTO      </span>                            <span class="co">#  OF THE SUN IS STORED IN 2D OF THE VAC</span>
033946,000118: 26,2113           54143                                    <a href="#524553">RES</a>                                   <span class="co">#  AREA.  THE POSITION VECTOR OF THE MOON</span>
033947,000119: 26,2114           54126                                    <a href="#4C5354494D45">LSTIME</a>                                <span class="co">#  IS STORED IN MPAC.</span>
<a name="4C554E504F53"></a>033948,000120: 26,2115           52170        <span class="sm">LUNPOS  </span>           <span class="in">AXT,1   </span> <span class="in">GOTO      </span>                            <span class="co">#  COMPUTES THE POSITION VECTOR OF THE MOON</span>
033949,000121: 26,2116           54162                                    <a href="#52454D">REM</a>                                   <span class="co">#  AND STORES IT IN MPAC.</span>
033950,000122: 26,2117           54126                                    <a href="#4C5354494D45">LSTIME</a>                                
<a name="4C554E56454C"></a>033951,000123: 26,2120           52170        <span class="sm">LUNVEL  </span>           <span class="in">AXT,1   </span> <span class="in">GOTO      </span>                            <span class="co">#  COMPUTES THE VELOCITY VECTOR OF THE MOON</span>
033952,000124: 26,2121           54173                                    <a href="#56454D">VEM</a>                                   <span class="co">#  AND STORES IT IN MPAC.</span>
033953,000125: 26,2122           54126                                    <a href="#4C5354494D45">LSTIME</a>                                
<a name="534F4C504F53"></a>033954,000126: 26,2123           76020        <span class="sm">SOLPOS  </span>           <span class="in">STQ     </span> <span class="in">AXT,1     </span>                            <span class="co">#  COMPUTES THE POSITION VECTOR OF THE SUN</span>
033955,000127: 26,2124           00047                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#5832">X2</a>                                    <span class="co">#  AND STORES IT IN MPAC.</span>
033956,000128: 26,2125           54143                                    <a href="#524553">RES</a>                                   
<a name="4C5354494D45"></a>033957,000129: 26,2126           54201        <span class="sm">LSTIME  </span>           <span class="in">SETPD   </span> <span class="in">SR        </span>                            
033958,000130: 26,2127           00001                                    0D                                    
033959,000131: 26,2130           20617                                    14D                                   
033960,000132: 26,2131           57571                           <span class="in">TAD     </span> <span class="in">DCOMP     </span>                            
033961,000133: 26,2132           01707                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#54455048454D">TEPHEM</a>                                
033962,000134: 26,2133           57571                           <span class="in">TAD     </span> <span class="in">DCOMP     </span>                            
033963,000135: 26,2134           02034                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#54494D454D4F">TIMEMO</a>                                
033964,000136: 26,2135           66261                           <span class="in">SL      </span> <span class="in">SSP       </span>                            
033965,000137: 26,2136           20221                                    16D                                   
033966,000138: 26,2137           00051                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#5331">S1</a>                                    
033967,000139: 26,2140           00006                                    6D                                    
033968,000140: 26,2141           77650                           <span class="in">GOTO    </span>                                       
033969,000141: 26,2142           00046                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#5831">X1</a>                                    
<a name="524553"></a>033970,000142: 26,2143           41206        <span class="sm">RES     </span>           <span class="in">PUSH    </span> <span class="in">DMP       </span>                            <span class="co">#                                        PD- 2</span>
033971,000143: 26,2144           02147                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#4F4D4547414553">OMEGAES</a>                               
033972,000144: 26,2145           71406                           <span class="in">PUSH    </span> <span class="in">COS       </span>                            <span class="co">#                                        PD- 4</span>
033973,000145: 26,2146           65361                           <span class="in">VXSC    </span> <span class="in">PDDL      </span>                            <span class="co">#                                        PD- 8</span>
033974,000146: 26,2147           02133                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#5245534F">RESO</a>                                  
033975,000147: 26,2150           63356                           <span class="in">SIN     </span> <span class="in">PDVL      </span>                            <span class="co">#                                        PD-10</span>
033976,000148: 26,2151           02133                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#5245534F">RESO</a>                                  
033977,000149: 26,2152           53406                           <span class="in">PUSH    </span> <span class="in">UNIT      </span>                            <span class="co">#                                        PD-16</span>
033978,000150: 26,2153           53435                           <span class="in">VXV     </span> <span class="in">UNIT      </span>                            
033979,000151: 26,2154           02141                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#5645534F">VESO</a>                                  
033980,000152: 26,2155           76435                           <span class="in">VXV     </span> <span class="in">VSL1      </span>                            <span class="co">#                                        PD-10</span>
033981,000153: 26,2156           53361                           <span class="in">VXSC    </span> <span class="in">VAD       </span>                            <span class="co">#                                        PD-02</span>
033982,000154: 26,2157           52172                           <span class="in">VSL1    </span> <span class="in">GOTO      </span>                            <span class="co">#  RES IN METERS X B-38 IN MPAC.</span>
033983,000155: 26,2160           00047                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#5832">X2</a>                                    
<a name="52455341"></a>033984,000156: 26,2161           14003        <span class="sm">RESA    </span>           <span class="in">STODL   </span> 2D                                    <span class="co">#  RES IN METERS X B-38 IN 2D OF VAC.    PD- 0</span>
<a name="52454D"></a>033985,000157: 26,2162           63370        <span class="sm">REM     </span>           <span class="in">AXT,1   </span> <span class="in">PDVL      </span>                            <span class="co">#                                        PD- 2</span>
033986,000158: 26,2163           00066                                    54D                                   
033987,000159: 26,2164           02037                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#5645434F454D">VECOEM</a>                                
<a name="52454D41"></a>033988,000160: 26,2165           52761        <span class="sm">REMA    </span>           <span class="in">VXSC    </span> <span class="in">VAD*      </span>                            
033989,000161: 26,2166           00001                                    0D                                    
033990,000162: 26,2167           02133                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#5645434F454D">VECOEM</a>     +60D,1                     
033991,000163: 26,2170           72500                           <span class="in">TIX,1   </span> <span class="in">VSL2      </span>                            <span class="co">#  REM IN METERS X B-29 IN MPAC.</span>
033992,000164: 26,2171           54165                                    <a href="#52454D41">REMA</a>                                  
033993,000165: 26,2172           77616                           <span class="in">RVQ     </span>                                       
<a name="56454D"></a>033994,000166: 26,2173           65370        <span class="sm">VEM     </span>           <span class="in">AXT,1   </span> <span class="in">PDDL      </span>                            <span class="co">#                                        PD- 2</span>
033995,000167: 26,2174           00060                                    48D                                   
033996,000168: 26,2175           14214                                    <a href="#4E494E454234">NINEB4</a>                                
033997,000169: 26,2176           74206                           <span class="in">PUSH    </span> <span class="in">VXSC      </span>                            <span class="co">#                                        PD- 4</span>
033998,000170: 26,2177           02037                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#5645434F454D">VECOEM</a>                                
<a name="56454D41"></a>033999,000171: 26,2200           77761        <span class="sm">VEMA    </span>           <span class="in">VXSC    </span>                                       
034000,000172: 26,2201           00001                                    0D                                    
034001,000173: 26,2202           14005                           <span class="in">STODL   </span> 4D                                    <span class="co">#                                        PD- 2</span>
034002,000174: 26,2203           41425                           <span class="in">DSU     </span> <span class="in">PUSH      </span>                            <span class="co">#                                        PD- 4</span>
034003,000175: 26,2204           14216                                    <a href="#4F4E454234">ONEB4</a>                                 
034004,000176: 26,2205           53357                           <span class="in">VXSC*   </span> <span class="in">VAD       </span>                            
034005,000177: 26,2206           02125                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#5645434F454D">VECOEM</a>     +54D,1                     
034006,000178: 26,2207           00005                                    4D                                    
034007,000179: 26,2210           72500                           <span class="in">TIX,1   </span> <span class="in">VSL2      </span>                            <span class="co">#  VEM IN METERS/CS X B-7 IN MPAC.</span>
034008,000180: 26,2211           54200                                    <a href="#56454D41">VEMA</a>                                  
034009,000181: 26,2212           77616                           <span class="in">RVQ     </span>                                       
<a name="4E494E454234"></a>034010,000182: 26,2213           22000 00000  <span class="sm">NINEB4  </span>           <span class="ps">2DEC    </span> 9.0        B-4                        
034011,000183: 
<a name="4F4E454234"></a>034012,000184: 26,2215           02000 00000  <span class="sm">ONEB4   </span>           <span class="ps">2DEC    </span> 1.0        B-4                        
034013,000185: 
034014,000186: 
034015,000187: 

End of include-file LUNAR_AND_SOLAR_EPHEMERIDES_SUBROUTINES.agc.  Parent file is <a href="MAIN.agc.html">MAIN.agc</a>
</pre>
</span>
</p>
</body>
</html>
